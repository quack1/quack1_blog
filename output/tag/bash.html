<!DOCTYPE html>
<html lang="en">
<head>
        <title>Quack1@Blog - bash</title>
        <meta charset="utf-8" />
        <link rel="stylesheet" href="../theme/css/main.css" type="text/css" />
                <link href="http://quack1.no-ip.org/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Quack1@Blog Atom Feed" />
                
        <link rel="icon" type="image/png" href="./static/upload/favicon.png" />

        <!--[if IE]>
                <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

        <!--[if lte IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="../css/ie.css"/>
                <script src="../js/IE8.js" type="text/javascript"></script><![endif]-->

        <!--[if lt IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="../css/ie6.css"/><![endif]-->

</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="../">Quack1@Blog </a></h1>
                <nav><ul>
                                                                                                    <li ><a href="../category/blog.html">Blog</a></li>
                                    <li ><a href="../category/geek.html">Geek</a></li>
                                    <li ><a href="../category/linux.html">Linux</a></li>
                                    <li ><a href="../category/musique.html">Musique</a></li>
                                    <li ><a href="../category/pentest.html">Pentest</a></li>
                                    <li ><a href="../category/securite.html">Securité</a></li>
                                    <li ><a href="../category/ubuntu.html">Ubuntu</a></li>
                                    <li ><a href="../category/wtf.html">WTF</a></li>
                                </ul></nav>
        </header><!-- /#banner -->
                
            

                            <aside id="featured" class="body">
                <article>
                    <h1 class="entry-title"><a href="../customisation-de-mon-bashrc.html">Customisation de mon .bashrc</a></h1> 
                    <footer class="post-info">
        <abbr class="published" title="2012-10-05T16:52:00">
                ven. 05 octobre 2012
        </abbr>

                <address class="vcard author">
                By <a class="url fn" href="../author/quack1.html">Quack1</a>
        </address>
        <p>In <a href="../category/linux.html">Linux</a>. </p>
<p>tags: <a href="../tag/bash.html">bash</a><a href="../tag/customisation.html">customisation</a><a href="../tag/linux.html">linux</a><a href="../tag/trick.html">trick</a></p>
</footer><!-- /.post-info --><p>Petit article pour me souvenir d'un bout de script que j'ai placé à la
fin de mon fichier .bashrc, qui me permet d'obtenir 2-3 infos sur mon
système au lancement d'un terminal. Au menu, la date, l'heure, la
version de l'OS, du noyau, l'uptime et les adresses IP de mes interfaces
réseaux. Au final, j'obtiens ce rendu :</p>
<p><img src="static/upload/custombash.png" width="600" align="center" /></p>
<p>Première chose que j'ajoute au fichier de configuration de Bash : la
définition de quelques couleurs. En effet, ça ne se voit pas beaucoup
ici, mais les infos affichées en haut du terminal sont en gris clair. Je
peux donc choisir des couleurs différentes pour chaque machine, et
pouvoir différencier mes terminaux rapidement.</p>
<pre>
black='e[0;30m'
blue='e[0;34m'
green='e[0;32m'
cyan='e[0;36m'
red='e[0;31m'
purple='e[0;35m'
brown='e[0;33m'
lightgray='e[0;37m'
darkgray='e[1;30m'
lightblue='e[1;34m'
lightgreen='e[1;32m'
lightcyan='e[1;36m'
lightred='e[1;31m'
lightpurple='e[1;35m'
yellow='e[1;33m'
white='e[1;37m'
nc='e[0m'
</pre>

<p>Ensuite, j'ai les deux parties les plus longues du script (au passage,
si quelqu'un voit comment faire mieux, je suis preneur :-) ). J'affiche
sous les infos mon login et le nom de ma machine, le tout entouré d'une
ligne. Le problème, c'est que je peux avoir plusieurs tailles de
fenêtres, et les traits seraient trop petits ou trop grands. J'ai donc
une boucle pour n'afficher que le bon nombre de tirets :</p>
<pre>
theUser="───────[$USER@$HOSTNAME]"
lgth=$(($COLUMNS-${#theUser}))
i=0
while [[ $i -lt $lgth ]]; do
  theUser="$theUser─"
  (( i += 1 ))
done
</pre>

<p>Ensuite, je cherche à récupérer les adresses IP de mes interfaces
réseaux. Problème : certaines interfaces n'ont pas d'adresses IP
définies, et d'autres sont inutilisées (adresses virtuelles de
communication avec mes VM). J'ai donc un bout de script un peu moche
avec une boucle et des conditions...</p>
<pre>
ip_adress=""
for if in eth0 wlan0
do
    ip=$(ip addr show dev $if | grep "inet "| awk '{print $2}')
    if [[ "$ip" ]] 
    then
    if [[ -z "$ip_adress" ]]
    then
        ip_adress="        ${lightgray}$if : $ip" 
    else
        ip_adress="$ip_adressn                    ${lightgray}$if : $ip"
    fi
    fi
done
ip=$(curl -s 'http://canihazip.com/s/')
if="IP Publique"
if [[ "$ip" ]]
    then
        if [[ -z "$ip_adress" ]]
        then
            ip_adress="        ${lightgray}$if : $ip"
        else
            ip_adress="$ip_adressn                    ${lightgray}$if : $ip"
        fi
    fi
if [[ -n ip_adress ]]
then
    ip_adress="  Network : $ip_adress"
fi
</pre>

<p><em>Notez que les espaces permettent juste d'avoir un affichage "propre"
des valeurs.</em></p>
<p>Enfin, je ne fais qu'afficher les données dans mon terminal avec de la
substitution de commandes pour afficher les infos utiles :</p>
<pre>
clear
echo -e ""
echo -e "  ${lightgray}Today   :         `date`"
echo -e "  ${lightgray}System  :         `lsb_release -i | cut -f 2` - `lsb_release -c | cut -f 2` - `lsb_release
 -r | cut -f 2`"
echo -e "  ${lightgray}Kernel  :         `uname -o` `uname -r` - `uname -m`"
echo -e "  ${lightgray}Uptime  :        `uptime`"
echo -e "$ip_adress"
echo -e "${lightgray}$theUser"
</pre>

<p>Tous ces petits bouts de codes ne ralentissent pas (pas trop)
l'ouverture de mon terminal, seul le curl et les boucles sont un peu
lents, mais ce n'est pas trop gênant!</p>
<p>Tout ceci est basé sur un script écrit par <a href="https://twitter.com/VictorBersy/status/233125380423311361" title="@VictorBersy">@VictorBersy</a>.</p>                </article>
                            </aside><!-- /#featured -->
                            <section id="content" class="body">
                    <h1>Other articles</h1>
                    <hr />
                    <ol id="posts-list" class="hfeed">
                                                

                 
                        <li><article class="hentry">    
                <header>
                    <h1><a href="../les-perles-de-climagic-et-co.html" rel="bookmark"
                           title="Permalink to Les perles de @climagic (et co)">Les perles de @climagic (et co)</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2012-09-25T21:47:00">
                mar. 25 septembre 2012
        </abbr>

                <address class="vcard author">
                By <a class="url fn" href="../author/quack1.html">Quack1</a>
        </address>
        <p>In <a href="../category/linux.html">Linux</a>. </p>
<p>tags: <a href="../tag/admin.html">admin</a><a href="../tag/bash.html">bash</a><a href="../tag/cli.html">cli</a><a href="../tag/climagic.html">climagic</a><a href="../tag/command.html">command</a><a href="../tag/fun.html">fun</a><a href="../tag/scripts.html">scripts</a><a href="../tag/tricsks.html">tricsks</a><a href="../tag/usefull.html">usefull</a></p>
</footer><!-- /.post-info -->                <p>Ça commence à faire un ~~petit~~ bon moment (juste 3 ou 4 mois) que je
n'ai rien publié sur ce blog. Un retour tout en douceur s'impose donc,
et pour cela, je vais faire d'une pierre deux coups, puisque je vais
également vider mes favoris <a href="http://twitter.com/_Quack1" title="@_Quack1">Twitter</a> :-)</p>
<p>En ...</p>
                <a class="readmore" href="../les-perles-de-climagic-et-co.html">read more</a>
                                </div><!-- /.entry-content -->
            </article></li>
                            </ol><!-- /#posts-list -->
                            <p class="paginator">
        Page 1 / 1
    </p>
                        </section><!-- /#content -->
                    <section id="extras" class="body">
                        <div class="blogroll">
                        <h2>blogroll</h2>
                        <ul>
                                                    <li><a href="http://docs.notmyidea.org/alexis/pelican/">Pelican</a></li>
                                                    <li><a href="http://python.org">Python.org</a></li>
                                                    <li><a href="http://jinja.pocoo.org">Jinja2</a></li>
                                                </ul>
                </div><!-- /.blogroll -->
                                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="http://quack1.no-ip.org/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>
                            
                                                    <li><a href="http://twitter.com/_Quack1">twitter</a></li>
                                                </ul>
                </div><!-- /.social -->
                </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-35393252-1']);
    _gaq.push(['_trackPageview']);
    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>
</body>
</html>